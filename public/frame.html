<!DOCTYPE html>
<html>
<head>
  <script src="vendors/webcomponentsjs/webcomponents-lite.min.js"></script>
  <link rel="import" href="vendors/more-routing/more-routing.html">
  <link rel="import" href="elements/management/google-auth.html">
  <link rel="import" href="elements/live-snooker-api.html">
  <link rel="import" href="elements/live-snooker.html">
  <link rel="import" href="elements/js/frame.html">
  <link rel="import" href="elements/frame-controller.html">
  <link rel="import" href="elements/frame-viewer.html">
</head>
<body>
  <dom-module id="frame-view">
    <template>
      <live-snooker-api id="api" host="<!-- @echo BACKEND_HOST -->"></live-snooker-api>
      <google-auth googleId="<!-- @echo GOOGLE_CLIENT_ID -->"></google-auth>
      <template is="dom-if" if="{{input}}">
        <frame-controller frame-id="{{frameId}}"></frame-controller>
      </template>
      <template is="dom-if" if="{{!input}}">
        <frame-viewer frame-id="{{frameId}}"></frame-viewer>
      </template>
    </template>
  </dom-module>

  <script>
    var QueryString = function () {
      // This function is anonymous, is executed immediately and 
      // the return value is assigned to QueryString!
      var query_string = {};
      var query = window.location.search.substring(1);
      var vars = query.split("&");
      for (var i=0;i<vars.length;i++) {
        var pair = vars[i].split("=");
            // If first entry with this name
        if (typeof query_string[pair[0]] === "undefined") {
          query_string[pair[0]] = pair[1];
            // If second entry with this name
        } else if (typeof query_string[pair[0]] === "string") {
          var arr = [ query_string[pair[0]], pair[1] ];
          query_string[pair[0]] = arr;
            // If third or later entry with this name
        } else {
          query_string[pair[0]].push(pair[1]);
        }
      } 
        return query_string;
    } ();

    Polymer({
      is: 'frame-view',
      properties: {
        frameId: String,
        input: Boolean
      },
      ready: function() {
        this.frameId = QueryString.frameId;
        this.input = JSON.parse(QueryString.input);
      }
    });
  </script>

  <frame-view></frame-view>
</body>
</html>
