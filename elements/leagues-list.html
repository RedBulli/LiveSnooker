<link rel="import" href="../vendors/polymer/polymer.html">
<link rel="import" href="js/leagues.html">

<dom-module id="leagues-list">
  <template>
    <livesnooker-api id="api"></livesnooker-api>
    <a href="{{ newLeagueUrl() }}">Create new league</a>
    <br>
    Change the current league:
    <ul>
      <template is="dom-repeat" items="{{leagues}}">
        <li>
          <a href="{{ leagueUrl(item) }}">{{item.attributes.name}}</a>
        </li>
      </template>
    </ul>
  </template>
</dom-module>

<script>
  Polymer({
    is: 'leagues-list',
    properties: {
      leagues: Array
    },
    newLeagueUrl: function() {
      return MoreRouting.urlFor('newLeague');
    },
    leagueUrl: function(league) {
      return MoreRouting.urlFor('livesnooker', {leagueId: league.id});
    },
    ready: function() {
      this.leaguesCollection = new Leagues();
      this.leaguesCollection.setApiClient(this.$.api);
      var _this = this;
      this.leaguesCollection.fetch({
        success: function() {
          _this.leagues = _this.leaguesCollection.models;
        }
      });
    }
  });
</script>
