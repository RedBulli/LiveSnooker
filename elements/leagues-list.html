<link rel="import" href="../vendors/polymer/polymer.html">
<link rel="import" href="js/leagues.html">
<link rel="import" href="new-league-form.html">

<dom-module id="leagues-list">
  <style>
    #content {
      margin-left: 1em;
    }
  </style>

  <template>
    <livesnooker-api id="api"></livesnooker-api>
    <div id="content">
      <template is="dom-if" if="[[leagues.length]]">
        <h2>Your leagues:</h2>
        <ul class="uk-list">
          <template is="dom-repeat" items="[[leagues]]">
            <li>
              <a href="[[ leagueUrl(item) ]]">[[item.attributes.name]]</a>
            </li>
          </template>
        </ul>
      </template>
      <template is="dom-if" if="[[!leagues.length]]">
        You don't admin or belong to any league.
      </template>
      <br>
      <new-league-form></new-league-form>
    </div>
  </template>
</dom-module>

<script>
  Polymer({
    is: 'leagues-list',
    properties: {
      leagues: {
        type: Array,
        value: []
      }
    },
    leagueUrl: function(league) {
      return MoreRouting.urlFor('livesnooker', {leagueId: league.id});
    },
    ready: function() {
      this.leaguesCollection = new Leagues();
      this.leaguesCollection.setApiClient(this.$.api);
      var _this = this;
      this.leaguesCollection.fetch({
        success: function() {
          _this.leagues = _this.leaguesCollection.models;
        }
      });
    }
  });
</script>
