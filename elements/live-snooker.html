<link rel="import" href="../vendors/polymer/polymer.html">
<link rel="import" href="live-snooker-api.html">
<link rel="import" href="js/frame.html">
<link rel="import" href="js/players.html">
<link rel="import" href="new-frame-form.html">
<link rel="import" href="js/league.html">
<link rel="import" href="stream-channel.html">
<link rel="import" href="event-stream.html">
<link rel="import" href="js/vendor/jquery.html">

<dom-module name="live-snooker">
  <style>
    .video-status {
      display: none;
    }
    .winner {
      font-weight: bold;
    }
  </style>

  <template>
    <live-snooker-api id="api"></live-snooker-api>
    <template is="dom-if" if="{{streamUrl}}">
      <event-stream stream-url="{{streamUrl}}" on-event="onStreamEvent"></event-stream>
    </template>
    <stream-channel id="stream-channel" leagueId="{{leagueId}}" on-new-stream="newStream" on-stream-closed="streamClosed"></stream-channel>
    <h2>Ongoing frames</h2>
    <ol id="framelist">
      <template id="unfinished" is="dom-repeat" items="{{frames}}" filter="unfinishedFrame">
        <li data-id$="{{item.id}}">
          <span>{{item.attributes.Player1.attributes.name}}</span> - <span>{{item.attributes.Player2.attributes.name}}</span>
          <a href$="{{computeViewLink(item)}}" on-click="showFrame">Show</a>
          <a href$="{{computeControlLink(item)}}" on-click="controlFrame">Control</a>
          <span class="video-status">VIDEO</span>
        </li>
      </template>
    </ol>
    <h2>Finished frames</h2>
    <ol>
      <template id="finished" is="dom-repeat" items="{{frames}}" filter="finishedFrame">
        <li>
          <span class$="{{ computeWinnerClass(item, item.attributes.Player1) }}">{{item.attributes.Player1.attributes.name}}</span> - 
          <span class$="{{ computeWinnerClass(item, item.attributes.Player2) }}">{{item.attributes.Player2.attributes.name}}</span>
          <a href="/" on-click="showBreaks">View breaks</a>
        </li>
      </template>
    </ol>
    Create a new frame <br>
    <new-frame-form league="{{league}}"></new-frame-form>
  </template>
</dom-module>

<script src="live-snooker.js"></script>
