<link rel="import" href="../../vendors/polymer/polymer.html">

<dom-module id="event-stream" hidden>
</dom-module>

<script>
  Polymer({
    is: 'event-stream',
    properties: {
      streamUrl: {
        type: String,
        observer: '_onStreamUrlChange'
      }
    },
    _onStreamUrlChange: function() {
      var source = new EventSource(this.streamUrl);
      source.onmessage = (function (event) {
        this.fire("event", JSON.parse(event.data));
      }).bind(this);
    }
  });
</script>
