<link rel="import" href="../vendors/polymer/polymer.html">
<link rel="import" href="frame-score-view.html">
<link rel="import" href="break-history-view.html">
<link rel="import" href="frame-novideo-view.html">
<link rel="import" href="p2p-video.html">
<link rel="import" href="../vendors/paper-toggle-button/paper-toggle-button.html">
<link rel="import" href="uikit.html">

<dom-module id="x-frame-view">
  <style>
    #gameview {
      width: 40em;
    }
  </style>

  <template>
    <div class="uk-grid">
      <div class="uk-width-medium-4-5">
        <div id="gameview">
          <p2p-video id="video" class="video" socket-url="[[socketUrl]]" league-id="[[frame.attributes.League.id]]" frame-id="[[frame.id]]">
            <template is="dom-if" if="[[video]]">
              <figure class="uk-overlay">
                  <div id="cam" class="video-container" width="640" height="480"></div>
                  <figcaption class="uk-overlay-panel uk-overlay-bottom uk-text-center">
                    <frame-score-view id="on-video-score" frame="[[frame]]"></frame-score-view>
                  </figcaption>
              </figure>
            </template>
          </p2p-video>
          <template is="dom-if" if="[[!video]]">
            <frame-novideo-view frame="[[frame]]"></frame-novideo-view>
          </template>
        </div>
      </div>
      <div class="uk-width-medium-1-5">
        <break-history-view breaks="[[frame.attributes.shotGroups]]"></break-history-view>
      </div>
    </div>
  </template>
</dom-module>

<script>
  Polymer({
    is: 'x-frame-view',
    properties: {
      frame: Object,
      video: {
        type: Boolean,
        value: false
      },
      socketUrl: String,
      videoInput: {
        type: Boolean,
        value: false
      }
    },
    openVideo: function() {
      var videoEl = Polymer.dom(this).node.querySelector("p2p-video");
      videoEl.open();
    },
    closeVideo: function() {
      var videoEl = Polymer.dom(this).node.querySelector("p2p-video");
      videoEl.leave();
    },
    ready: function() {
      if (this.video && this.videoInput) {
        this.openVideo();
      }
    }
  });
</script>
