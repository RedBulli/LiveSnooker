<link rel="import" href="../vendors/polymer/polymer.html">

<dom-module id="backbone-collection-renderer">
  <template>
    <content id="content"></content>
  </template>
</dom-module>

<script>
  Polymer({
    is: 'backbone-collection-renderer',
    properties: {
      collection: {
        type: Object,
        observer: '_onCollectionChange'
      },
      models: {
        type: Array,
        value: function() {return [];}
      }
    },
    _onCollectionChange: function(next, prev) {
      if (prev) {
        prev.off(null, null, this); // Remove all callbacks with this context
      }
      next.on("add remove change reset", this.renderModelsToTemplate, this);
      var el = Polymer.dom(this).node.querySelector(".content");
      el.items = next.models;
      this.renderModelsToTemplate();
    },
    renderModelsToTemplate: function() {
      var _this = this;
      this.splice('models', 0, this.models.length);
      this.collection.each(function(model) {
        _this.push('models', model);
      });
    },
    ready: function() {
    }
  });
</script>
